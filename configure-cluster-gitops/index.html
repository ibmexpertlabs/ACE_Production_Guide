<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="App Connect Enterprise Production Deployment Guide for OpenShift"><meta name=author content="IBM Client Engineering"><link href=https://ibmexpertlabs.github.io/ACE_Production_Guide/configure-cluster-gitops/ rel=canonical><link href=../create-cluster/ rel=prev><link rel=icon href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.14"><title>Set Up GitOps - ACE Production Guide</title><link rel=stylesheet href=../assets/stylesheets/main.342714a4.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#configure-the-cluster-for-gitops class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="ACE Production Guide" class="md-header__button md-logo" aria-label="ACE Production Guide" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> ACE Production Guide </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Set Up GitOps </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/ibmexpertlabs/ACE_Production_Guide title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> ibmexpertlabs/ACE_Production_Guide </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../authors/ class=md-tabs__link> Meet the Authors </a> </li> <li class=md-tabs__item> <a href=../ace-tutorial/ class=md-tabs__link> The ACE Tutorial </a> </li> <li class=md-tabs__item> <a href=../target-architecture/ class=md-tabs__link> Target Architecture </a> </li> <li class=md-tabs__item> <a href=../create-cluster/ class=md-tabs__link> Create the Cluster </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=./ class=md-tabs__link> Configure the Cluster </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="ACE Production Guide" class="md-nav__button md-logo" aria-label="ACE Production Guide" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> ACE Production Guide </label> <div class=md-nav__source> <a href=https://github.com/ibmexpertlabs/ACE_Production_Guide title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> ibmexpertlabs/ACE_Production_Guide </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../authors/ class=md-nav__link> <span class=md-ellipsis> Meet the Authors </span> </a> </li> <li class=md-nav__item> <a href=../ace-tutorial/ class=md-nav__link> <span class=md-ellipsis> The ACE Tutorial </span> </a> </li> <li class=md-nav__item> <a href=../target-architecture/ class=md-nav__link> <span class=md-ellipsis> Target Architecture </span> </a> </li> <li class=md-nav__item> <a href=../create-cluster/ class=md-nav__link> <span class=md-ellipsis> Create the Cluster </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6 checked> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex> <span class=md-ellipsis> Configure the Cluster </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=true> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Configure the Cluster </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Set Up GitOps </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Set Up GitOps </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#introduction class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> <nav class=md-nav aria-label=Introduction> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gitops-architecture-overview class=md-nav__link> <span class=md-ellipsis> GitOps Architecture Overview </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#prerequisites class=md-nav__link> <span class=md-ellipsis> Prerequisites </span> </a> </li> <li class=md-nav__item> <a href=#setting-up-github-organization class=md-nav__link> <span class=md-ellipsis> Setting up GitHub Organization </span> </a> <nav class=md-nav aria-label="Setting up GitHub Organization"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-create-a-new-github-organization class=md-nav__link> <span class=md-ellipsis> 1. Create a New GitHub Organization </span> </a> </li> <li class=md-nav__item> <a href=#2-set-up-repository-access class=md-nav__link> <span class=md-ellipsis> 2. Set Up Repository Access </span> </a> </li> <li class=md-nav__item> <a href=#3-github-authentication-setup class=md-nav__link> <span class=md-ellipsis> 3. GitHub Authentication Setup </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#clone-sample-gitops-repositories class=md-nav__link> <span class=md-ellipsis> Clone Sample GitOps Repositories </span> </a> <nav class=md-nav aria-label="Clone Sample GitOps Repositories"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#repository-structure class=md-nav__link> <span class=md-ellipsis> Repository Structure </span> </a> </li> <li class=md-nav__item> <a href=#clone-the-repositories class=md-nav__link> <span class=md-ellipsis> Clone the Repositories </span> </a> </li> <li class=md-nav__item> <a href=#review-repository-structure class=md-nav__link> <span class=md-ellipsis> Review Repository Structure </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#installing-argocd class=md-nav__link> <span class=md-ellipsis> Installing ArgoCD </span> </a> <nav class=md-nav aria-label="Installing ArgoCD"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-install-argocd-operator class=md-nav__link> <span class=md-ellipsis> 1. Install ArgoCD Operator </span> </a> </li> <li class=md-nav__item> <a href=#2-verify-installation class=md-nav__link> <span class=md-ellipsis> 2. Verify Installation </span> </a> </li> <li class=md-nav__item> <a href=#3-verify-cluster-roles class=md-nav__link> <span class=md-ellipsis> 3. Verify Cluster Roles </span> </a> </li> <li class=md-nav__item> <a href=#4-remove-default-instance class=md-nav__link> <span class=md-ellipsis> 4. Remove Default Instance </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#creating-a-custom-argocd-instance class=md-nav__link> <span class=md-ellipsis> Creating a Custom ArgoCD Instance </span> </a> <nav class=md-nav aria-label="Creating a Custom ArgoCD Instance"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-review-custom-health-checks class=md-nav__link> <span class=md-ellipsis> 1. Review Custom Health Checks </span> </a> </li> <li class=md-nav__item> <a href=#2-create-custom-argocd-instance class=md-nav__link> <span class=md-ellipsis> 2. Create Custom ArgoCD Instance </span> </a> </li> <li class=md-nav__item> <a href=#3-wait-for-instance-to-be-ready class=md-nav__link> <span class=md-ellipsis> 3. Wait for Instance to be Ready </span> </a> </li> <li class=md-nav__item> <a href=#4-configure-ssl-certificate-optional class=md-nav__link> <span class=md-ellipsis> 4. Configure SSL Certificate (Optional) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#accessing-argocd class=md-nav__link> <span class=md-ellipsis> Accessing ArgoCD </span> </a> <nav class=md-nav aria-label="Accessing ArgoCD"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-get-argocd-url class=md-nav__link> <span class=md-ellipsis> 1. Get ArgoCD URL </span> </a> </li> <li class=md-nav__item> <a href=#2-access-argocd-console class=md-nav__link> <span class=md-ellipsis> 2. Access ArgoCD Console </span> </a> </li> <li class=md-nav__item> <a href=#3-authentication-options class=md-nav__link> <span class=md-ellipsis> 3. Authentication Options </span> </a> <nav class=md-nav aria-label="3. Authentication Options"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#option-1-argocd-administrator-recommended class=md-nav__link> <span class=md-ellipsis> Option 1: ArgoCD Administrator (Recommended) </span> </a> </li> <li class=md-nav__item> <a href=#option-2-openshift-sso class=md-nav__link> <span class=md-ellipsis> Option 2: OpenShift SSO </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#4-argocd-dashboard class=md-nav__link> <span class=md-ellipsis> 4. ArgoCD Dashboard </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#connect-argocd class=md-nav__link> <span class=md-ellipsis> Connect ArgoCD </span> </a> <nav class=md-nav aria-label="Connect ArgoCD"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-review-the-bootstrap-single-cluster-argocd-application class=md-nav__link> <span class=md-ellipsis> 1. Review the Bootstrap-Single-Cluster ArgoCD Application </span> </a> </li> <li class=md-nav__item> <a href=#2-apply-argocd-bootstrapyaml-to-the-cluster class=md-nav__link> <span class=md-ellipsis> 2. Apply ArgoCD Bootstrap.yaml to the Cluster </span> </a> </li> <li class=md-nav__item> <a href=#3-verify-the-bootstrap-deployment class=md-nav__link> <span class=md-ellipsis> 3. Verify the Bootstrap Deployment </span> </a> </li> <li class=md-nav__item> <a href=#4-using-the-ui-to-view-the-newly-deployed-argocd-applications class=md-nav__link> <span class=md-ellipsis> 4. Using the UI to View the Newly Deployed ArgoCD Applications </span> </a> </li> <li class=md-nav__item> <a href=#5-the-bootstrap-single-cluster-argocd-application-in-detail class=md-nav__link> <span class=md-ellipsis> 5. The Bootstrap-Single-Cluster ArgoCD Application in Detail </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#next-steps class=md-nav__link> <span class=md-ellipsis> Next Steps </span> </a> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> <nav class=md-nav aria-label=Troubleshooting> <ul class=md-nav__list> <li class=md-nav__item> <a href=#common-issues class=md-nav__link> <span class=md-ellipsis> Common Issues </span> </a> </li> <li class=md-nav__item> <a href=#support-resources class=md-nav__link> <span class=md-ellipsis> Support Resources </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#introduction class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> <nav class=md-nav aria-label=Introduction> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gitops-architecture-overview class=md-nav__link> <span class=md-ellipsis> GitOps Architecture Overview </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#prerequisites class=md-nav__link> <span class=md-ellipsis> Prerequisites </span> </a> </li> <li class=md-nav__item> <a href=#setting-up-github-organization class=md-nav__link> <span class=md-ellipsis> Setting up GitHub Organization </span> </a> <nav class=md-nav aria-label="Setting up GitHub Organization"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-create-a-new-github-organization class=md-nav__link> <span class=md-ellipsis> 1. Create a New GitHub Organization </span> </a> </li> <li class=md-nav__item> <a href=#2-set-up-repository-access class=md-nav__link> <span class=md-ellipsis> 2. Set Up Repository Access </span> </a> </li> <li class=md-nav__item> <a href=#3-github-authentication-setup class=md-nav__link> <span class=md-ellipsis> 3. GitHub Authentication Setup </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#clone-sample-gitops-repositories class=md-nav__link> <span class=md-ellipsis> Clone Sample GitOps Repositories </span> </a> <nav class=md-nav aria-label="Clone Sample GitOps Repositories"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#repository-structure class=md-nav__link> <span class=md-ellipsis> Repository Structure </span> </a> </li> <li class=md-nav__item> <a href=#clone-the-repositories class=md-nav__link> <span class=md-ellipsis> Clone the Repositories </span> </a> </li> <li class=md-nav__item> <a href=#review-repository-structure class=md-nav__link> <span class=md-ellipsis> Review Repository Structure </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#installing-argocd class=md-nav__link> <span class=md-ellipsis> Installing ArgoCD </span> </a> <nav class=md-nav aria-label="Installing ArgoCD"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-install-argocd-operator class=md-nav__link> <span class=md-ellipsis> 1. Install ArgoCD Operator </span> </a> </li> <li class=md-nav__item> <a href=#2-verify-installation class=md-nav__link> <span class=md-ellipsis> 2. Verify Installation </span> </a> </li> <li class=md-nav__item> <a href=#3-verify-cluster-roles class=md-nav__link> <span class=md-ellipsis> 3. Verify Cluster Roles </span> </a> </li> <li class=md-nav__item> <a href=#4-remove-default-instance class=md-nav__link> <span class=md-ellipsis> 4. Remove Default Instance </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#creating-a-custom-argocd-instance class=md-nav__link> <span class=md-ellipsis> Creating a Custom ArgoCD Instance </span> </a> <nav class=md-nav aria-label="Creating a Custom ArgoCD Instance"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-review-custom-health-checks class=md-nav__link> <span class=md-ellipsis> 1. Review Custom Health Checks </span> </a> </li> <li class=md-nav__item> <a href=#2-create-custom-argocd-instance class=md-nav__link> <span class=md-ellipsis> 2. Create Custom ArgoCD Instance </span> </a> </li> <li class=md-nav__item> <a href=#3-wait-for-instance-to-be-ready class=md-nav__link> <span class=md-ellipsis> 3. Wait for Instance to be Ready </span> </a> </li> <li class=md-nav__item> <a href=#4-configure-ssl-certificate-optional class=md-nav__link> <span class=md-ellipsis> 4. Configure SSL Certificate (Optional) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#accessing-argocd class=md-nav__link> <span class=md-ellipsis> Accessing ArgoCD </span> </a> <nav class=md-nav aria-label="Accessing ArgoCD"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-get-argocd-url class=md-nav__link> <span class=md-ellipsis> 1. Get ArgoCD URL </span> </a> </li> <li class=md-nav__item> <a href=#2-access-argocd-console class=md-nav__link> <span class=md-ellipsis> 2. Access ArgoCD Console </span> </a> </li> <li class=md-nav__item> <a href=#3-authentication-options class=md-nav__link> <span class=md-ellipsis> 3. Authentication Options </span> </a> <nav class=md-nav aria-label="3. Authentication Options"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#option-1-argocd-administrator-recommended class=md-nav__link> <span class=md-ellipsis> Option 1: ArgoCD Administrator (Recommended) </span> </a> </li> <li class=md-nav__item> <a href=#option-2-openshift-sso class=md-nav__link> <span class=md-ellipsis> Option 2: OpenShift SSO </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#4-argocd-dashboard class=md-nav__link> <span class=md-ellipsis> 4. ArgoCD Dashboard </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#connect-argocd class=md-nav__link> <span class=md-ellipsis> Connect ArgoCD </span> </a> <nav class=md-nav aria-label="Connect ArgoCD"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-review-the-bootstrap-single-cluster-argocd-application class=md-nav__link> <span class=md-ellipsis> 1. Review the Bootstrap-Single-Cluster ArgoCD Application </span> </a> </li> <li class=md-nav__item> <a href=#2-apply-argocd-bootstrapyaml-to-the-cluster class=md-nav__link> <span class=md-ellipsis> 2. Apply ArgoCD Bootstrap.yaml to the Cluster </span> </a> </li> <li class=md-nav__item> <a href=#3-verify-the-bootstrap-deployment class=md-nav__link> <span class=md-ellipsis> 3. Verify the Bootstrap Deployment </span> </a> </li> <li class=md-nav__item> <a href=#4-using-the-ui-to-view-the-newly-deployed-argocd-applications class=md-nav__link> <span class=md-ellipsis> 4. Using the UI to View the Newly Deployed ArgoCD Applications </span> </a> </li> <li class=md-nav__item> <a href=#5-the-bootstrap-single-cluster-argocd-application-in-detail class=md-nav__link> <span class=md-ellipsis> 5. The Bootstrap-Single-Cluster ArgoCD Application in Detail </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#next-steps class=md-nav__link> <span class=md-ellipsis> Next Steps </span> </a> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> <nav class=md-nav aria-label=Troubleshooting> <ul class=md-nav__list> <li class=md-nav__item> <a href=#common-issues class=md-nav__link> <span class=md-ellipsis> Common Issues </span> </a> </li> <li class=md-nav__item> <a href=#support-resources class=md-nav__link> <span class=md-ellipsis> Support Resources </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=configure-the-cluster-for-gitops>Configure the Cluster for GitOps<a class=headerlink href=#configure-the-cluster-for-gitops title="Permanent link">&para;</a></h1> <p><strong>Audience:</strong> Architects, Application Developers, Administrators</p> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p>In this topic, you will:</p> <ul> <li>Create a GitHub organization for GitOps repositories</li> <li>Clone and review sample GitOps repositories</li> <li>Install and configure ArgoCD for continuous deployment</li> <li>Set up custom ArgoCD instance with IBM Cloud Pak health checks</li> <li>Access and configure the ArgoCD web console</li> </ul> <p>By the end of this topic, you'll have all the basic components in place to perform GitOps in your cluster.</p> <h2 id=introduction>Introduction<a class=headerlink href=#introduction title="Permanent link">&para;</a></h2> <p>Continuous integration and continuous deployment (CI/CD) are at the core of a typical ACE deployment. They ensure that any changes to source applications and configurations are automatically built and tested before they are deployed, helping to ensure their correctness and the integrity of the cluster.</p> <p>ACE applications are defined, configured, and changed using a <strong>GitOps model</strong>. GitOps puts git repositories and git commands such as <code>git push</code> (to request a change) and <code>git merge</code> (to approve a change) at the heart of configuration management. A GitOps approach helps an organization implement best practices in version control and release governance based on a widely used open standard — <strong>git</strong>.</p> <h3 id=gitops-architecture-overview>GitOps Architecture Overview<a class=headerlink href=#gitops-architecture-overview title="Permanent link">&para;</a></h3> <p>The following diagram outlines the major components in a GitOps ACE CI/CD process:</p> <p><img alt="GitOps Architecture" src=../images/gitops-diagram.png></p> <p>Notice the clear separation of concerns:</p> <ul> <li> <p><strong>Tekton pipelines</strong> (OpenShift Pipelines) use Integration Application (message flows, ESQL, mapping, etc.) and configurations (serverconf, policy projects) source repositories to build and store successfully tested Kubernetes artifacts in a Git config repository or image registry. While Kubernetes resources (e.g., pods, routes...) can be created as part of the pipeline run to test the source change, these resources only last for the duration of the pipeline run. It is the resultant Git and container image registry resources that are used to affect changes to the cluster in a subsequent, asynchronous processing step controlled by ArgoCD.</p> </li> <li> <p><strong>ArgoCD applications</strong> (OpenShift GitOps) watch a Git config repository for changes built as a result of successful pipeline runs. This repository identifies the latest version of the application using information stored in Git and an image repository. OpenShift GitOps applies the Kubernetes resources thus identified to the cluster, resulting in new or updated Kubernetes resources that represent the changed ACE workflow applications and Integration Servers and its ecosystem, such as pods, routes, etc. In contrast to pipeline runs, OpenShift GitOps changes are durable; they remain as defined unless and until they are explicitly changed or deleted in the GitOps repository. Moreover, if the cluster resources drift from their Git config values, ArgoCD will restore them to their desired values; only changes that are applied to the Git config repository affect the long-term state of the cluster.</p> </li> </ul> <p>OpenShift Pipelines and OpenShift GitOps are used to separate <strong>Continuous Integration</strong> from <strong>Continuous Deployment</strong>. Often, the Tekton pipeline will perform its changes under a pull-request (PR) to provide an explicit approval mechanism for cluster changes. This is especially important in higher environments such as production which require a formal sign-off. Lower environments such as development often apply successful pipeline runs directly to the Git config repository that are immediately seen by ArgoCD and applied to the cluster.</p> <h2 id=prerequisites>Prerequisites<a class=headerlink href=#prerequisites title="Permanent link">&para;</a></h2> <p>Before attempting this section, you must have completed the following tasks:</p> <ul> <li>✅ Created an OCP cluster instance</li> <li>✅ Installed the <code>oc</code> command that matches your cluster version (4.19+ client, 4.16+ server)</li> <li>✅ Installed <code>npm</code>, <code>git</code>, <code>tree</code>, and <code>jq</code> commands</li> <li>✅ Have cluster administrator access</li> </ul> <div class="admonition tip"> <p class=admonition-title>Quick Setup</p> <p>Use our <a href=https://raw.githubusercontent.com/ibmexpertlabs/ACE_Production_Guide/main/prerequisites.sh>prerequisites script</a> to automatically install most required tools: <div class="language-bash highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>curl<span class=w> </span>-O<span class=w> </span>https://raw.githubusercontent.com/ibmexpertlabs/ACE_Production_Guide/main/prerequisites.sh
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>chmod<span class=w> </span>+x<span class=w> </span>prerequisites.sh
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>./prerequisites.sh
</span></code></pre></div></p> </div> <div class="admonition tip"> <p class=admonition-title>OpenShift CLI Installation</p> <p>Use these <a href=https://docs.openshift.com/container-platform/4.16/cli_reference/openshift_cli/getting-started-cli.html>instructions</a> to get the latest version of <code>oc</code>. Use <code>oc version</code> to confirm that you have: - <strong>Client Version:</strong> 4.19 or higher - <strong>Server Version:</strong> 4.16 or higher</p> </div> <h2 id=setting-up-github-organization>Setting up GitHub Organization<a class=headerlink href=#setting-up-github-organization title="Permanent link">&para;</a></h2> <p>In this section, we'll create the GitOps organization that contains the GitOps repositories used by ArgoCD to determine the state of our cluster. We'll copy a set of sample GitOps repositories as a starting point, make our own copy, and review its contents. Later in the tutorial, we'll customize it for our cluster.</p> <h3 id=1-create-a-new-github-organization>1. Create a New GitHub Organization<a class=headerlink href=#1-create-a-new-github-organization title="Permanent link">&para;</a></h3> <p>We're going to create a dedicated GitHub organization for the repositories used in this tutorial. This is good practice as it allows you to keep your production reference work separate from other git work, or try out multiple configurations using different organizations.</p> <ol> <li> <p>In your browser, navigate to <a href=https://github.com/settings/organizations>GitHub Organizations</a> to create a new GitHub organization.</p> </li> <li> <p>Click <strong>"New organization"</strong> and follow the setup process:</p> </li> </ol> <p><img alt="Create GitHub Organization" src=../images/create_organzation.png></p> <ol> <li> <p>Choose a descriptive name for your organization (e.g., <code>ace-production-gitops</code>)</p> </li> <li> <p>Select the <strong>Free</strong> plan (sufficient for this tutorial):</p> </li> </ol> <p><img alt="Select Free Plan" src=../images/pick-plan.png></p> <ol> <li>Complete the organization setup</li> </ol> <h3 id=2-set-up-repository-access>2. Set Up Repository Access<a class=headerlink href=#2-set-up-repository-access title="Permanent link">&para;</a></h3> <p>Once your organization is created, you'll need to set up proper access for ArgoCD to read your repositories:</p> <ol> <li>Navigate to your organization settings</li> <li>Go to <strong>Developer settings</strong> → <strong>Personal access tokens</strong> → <strong>Tokens (classic)</strong></li> <li>Generate a new token with the following permissions:</li> <li><code>repo</code> (Full control of private repositories)</li> <li> <p><code>read:org</code> (Read organization data)</p> </li> <li> <p>Save the token securely - you'll need it for ArgoCD configuration</p> </li> </ol> <h3 id=3-github-authentication-setup>3. GitHub Authentication Setup<a class=headerlink href=#3-github-authentication-setup title="Permanent link">&para;</a></h3> <p>To validate your GitHub authentication, you'll need to complete the GitHub CLI authorization process:</p> <ol> <li><strong>GitHub Authorization Request</strong> - You'll see an authorization page:</li> </ol> <p><img alt="GitHub Authorization" src=../images/git-auth.png></p> <ol> <li><strong>Authorization Confirmation</strong> - After successful authorization:</li> </ol> <p><img alt="GitHub Authorization Complete" src=../images/git-auth-done.png></p> <div class="admonition tip"> <p class=admonition-title>GitHub CLI Authentication</p> <p>This authentication process ensures that your local environment can interact with GitHub repositories securely. The authorization tokens are used by ArgoCD and other tools to access your GitOps repositories.</p> </div> <h2 id=clone-sample-gitops-repositories>Clone Sample GitOps Repositories<a class=headerlink href=#clone-sample-gitops-repositories title="Permanent link">&para;</a></h2> <p>The GitOps approach uses multiple repositories to manage different aspects of the deployment:</p> <h3 id=repository-structure>Repository Structure<a class=headerlink href=#repository-structure title="Permanent link">&para;</a></h3> <ul> <li><strong>multi-tenancy-gitops</strong> - Main GitOps orchestration repository</li> <li><strong>multi-tenancy-gitops-infra</strong> - Infrastructure resources (namespaces, RBAC, etc.)</li> <li><strong>multi-tenancy-gitops-services</strong> - Service operators and instances</li> <li><strong>multi-tenancy-gitops-apps</strong> - ACE applications and configurations</li> </ul> <h3 id=clone-the-repositories>Clone the Repositories<a class=headerlink href=#clone-the-repositories title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1># Clone the main GitOps repository</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>git<span class=w> </span>clone<span class=w> </span>https://github.com/ibmexpertlabs/multi-tenancy-gitops.git
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=nb>cd</span><span class=w> </span>multi-tenancy-gitops
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=c1># Clone the supporting repositories</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>git<span class=w> </span>clone<span class=w> </span>https://github.com/ibmexpertlabs/multi-tenancy-gitops-infra.git
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>git<span class=w> </span>clone<span class=w> </span>https://github.com/ibmexpertlabs/multi-tenancy-gitops-services.git
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>git<span class=w> </span>clone<span class=w> </span>https://github.com/ibmexpertlabs/multi-tenancy-gitops-apps.git
</span></code></pre></div> <h3 id=review-repository-structure>Review Repository Structure<a class=headerlink href=#review-repository-structure title="Permanent link">&para;</a></h3> <p>Take a moment to explore the repository structure:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1># View the main repository structure</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>tree<span class=w> </span>multi-tenancy-gitops<span class=w> </span>-L<span class=w> </span><span class=m>2</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=c1># Review the ArgoCD applications</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>ls<span class=w> </span>multi-tenancy-gitops/0-bootstrap/single-cluster/1-infrastructure/
</span></code></pre></div> <h2 id=installing-argocd>Installing ArgoCD<a class=headerlink href=#installing-argocd title="Permanent link">&para;</a></h2> <p>ArgoCD is the GitOps continuous delivery tool that will manage our cluster state based on Git repository contents.</p> <h3 id=1-install-argocd-operator>1. Install ArgoCD Operator<a class=headerlink href=#1-install-argocd-operator title="Permanent link">&para;</a></h3> <p>ArgoCD is installed via the OpenShift GitOps operator. The installation process creates:</p> <ul> <li>ArgoCD operator subscription</li> <li>Default ArgoCD instance</li> <li>Required cluster roles and bindings</li> </ul> <div class="language-bash highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=c1># Apply the ArgoCD installation manifests</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>oc<span class=w> </span>apply<span class=w> </span>-f<span class=w> </span>setup/ocp4x/argocd-operator/<span class=w> </span>-n<span class=w> </span>openshift-operators
</span></code></pre></div> <div class="admonition note"> <p class=admonition-title>Open Source Community Approach</p> <p>This guide is designed for community contribution. Users should fork this repository, customize it for their environment, and contribute improvements back to the community. The GitOps repositories are structured to be easily forked and customized.</p> </div> <h3 id=2-verify-installation>2. Verify Installation<a class=headerlink href=#2-verify-installation title="Permanent link">&para;</a></h3> <p>Monitor the installation progress:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=c1># Wait for the ArgoCD operator to be installed</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=k>while</span><span class=w> </span>!<span class=w> </span>oc<span class=w> </span><span class=nb>wait</span><span class=w> </span>crd<span class=w> </span>applications.argoproj.io<span class=w> </span>--timeout<span class=o>=</span>-1s<span class=w> </span>--for<span class=o>=</span><span class=nv>condition</span><span class=o>=</span>Established<span class=w> </span><span class=m>2</span>&gt;/dev/null<span class=p>;</span><span class=w> </span><span class=k>do</span><span class=w> </span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;Waiting for ArgoCD operator...&quot;</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=w>    </span>sleep<span class=w> </span><span class=m>30</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=k>done</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=c1># Wait for ArgoCD pods to be ready</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=k>while</span><span class=w> </span>!<span class=w> </span>oc<span class=w> </span><span class=nb>wait</span><span class=w> </span>pod<span class=w> </span>--timeout<span class=o>=</span>-1s<span class=w> </span>--for<span class=o>=</span><span class=nv>condition</span><span class=o>=</span>Ready<span class=w> </span>--all<span class=w> </span>-n<span class=w> </span>openshift-gitops<span class=w> </span><span class=m>2</span>&gt;/dev/null<span class=p>;</span><span class=w> </span><span class=k>do</span><span class=w> </span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;Waiting for ArgoCD pods...&quot;</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=w>    </span>sleep<span class=w> </span><span class=m>30</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=k>done</span>
</span></code></pre></div> <p>You should see: <div class="language-text highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>customresourcedefinition.apiextensions.k8s.io/applications.argoproj.io condition met
</span></code></pre></div></p> <h3 id=3-verify-cluster-roles>3. Verify Cluster Roles<a class=headerlink href=#3-verify-cluster-roles title="Permanent link">&para;</a></h3> <p>ArgoCD runs under a dedicated service account with custom cluster roles for governance:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=c1># Verify cluster roles are created</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>oc<span class=w> </span>get<span class=w> </span>clusterrole<span class=w> </span>custom-argocd-cluster-argocd-application-controller
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>oc<span class=w> </span>get<span class=w> </span>clusterrolebinding<span class=w> </span>openshift-gitops-argocd-application-controller
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>oc<span class=w> </span>get<span class=w> </span>clusterrolebinding<span class=w> </span>openshift-gitops-cntk-argocd-application-controller
</span></code></pre></div> <h3 id=4-remove-default-instance>4. Remove Default Instance<a class=headerlink href=#4-remove-default-instance title="Permanent link">&para;</a></h3> <p>The default ArgoCD instance isn't sufficient for our tutorial. We need to create a custom one:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=c1># Delete the default ArgoCD instance</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>oc<span class=w> </span>delete<span class=w> </span>gitopsservice<span class=w> </span>cluster<span class=w> </span><span class=o>||</span><span class=w> </span><span class=nb>true</span>
</span></code></pre></div> <h2 id=creating-a-custom-argocd-instance>Creating a Custom ArgoCD Instance<a class=headerlink href=#creating-a-custom-argocd-instance title="Permanent link">&para;</a></h2> <p>The default instance of ArgoCD provides built-in health checks for standard Kubernetes resources. However, these checks are not sufficient for the <strong>custom resources</strong> added by IBM Cloud Paks. We need to create a custom instance with IBM Cloud Pak-specific health checks.</p> <h3 id=1-review-custom-health-checks>1. Review Custom Health Checks<a class=headerlink href=#1-review-custom-health-checks title="Permanent link">&para;</a></h3> <p>Explore the custom health checks in the ArgoCD YAML:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>cat<span class=w> </span>setup/ocp4x/argocd-instance/argocd-instance.yaml
</span></code></pre></div> <p>Notice the custom health check for queue managers:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=nt>mq.ibm.com/QueueManager</span><span class=p>:</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=w>  </span><span class=nt>health.lua</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=w>    </span><span class=no>hs = {}</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=w>    </span><span class=no>if obj.status ~= nil then</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=w>      </span><span class=no>if obj.status.phase ~= nil then</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=w>        </span><span class=no>hs.message = obj.status.phase</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=w>        </span><span class=no>if obj.status.phase == &quot;Running&quot; then</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=w>          </span><span class=no>hs.status = &quot;Healthy&quot;</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=w>        </span><span class=no>else</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a><span class=w>          </span><span class=no>hs.status = &quot;Progressing&quot;</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=w>        </span><span class=no>end</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=w>        </span><span class=no>return hs</span>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a><span class=w>      </span><span class=no>end</span>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=w>    </span><span class=no>end</span>
</span><span id=__span-9-15><a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a><span class=w>    </span><span class=no>hs.status = &quot;Progressing&quot;</span>
</span><span id=__span-9-16><a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a><span class=w>    </span><span class=no>hs.message = &quot;Unknown&quot;</span>
</span><span id=__span-9-17><a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a><span class=w>    </span><span class=no>return hs</span>
</span></code></pre></div> <p>This logic is used by ArgoCD to determine when a queue manager is healthy.</p> <div class="admonition tip"> <p class=admonition-title>Custom Health Checks</p> <p>The custom ArgoCD instance includes IBM Cloud Pak-specific health checks for: - <strong>Queue Managers</strong> (<code>mq.ibm.com/QueueManager</code>) - <strong>Integration Servers</strong> (<code>appconnect.ibm.com/IntegrationServer</code>) - <strong>ACE Applications</strong> (<code>appconnect.ibm.com/Application</code>) - <strong>Other Cloud Pak resources</strong></p> <p>These health checks ensure ArgoCD can properly monitor the status of IBM Cloud Pak resources and provide accurate health assessments in the ArgoCD dashboard.</p> </div> <h3 id=2-create-custom-argocd-instance>2. Create Custom ArgoCD Instance<a class=headerlink href=#2-create-custom-argocd-instance title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=c1># Create the custom ArgoCD instance</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>oc<span class=w> </span>apply<span class=w> </span>-f<span class=w> </span>setup/ocp4x/argocd-instance/<span class=w> </span>-n<span class=w> </span>openshift-gitops
</span></code></pre></div> <p>You should see: <div class="language-text highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>argocd.argoproj.io/openshift-gitops-cntk created
</span></code></pre></div></p> <h3 id=3-wait-for-instance-to-be-ready>3. Wait for Instance to be Ready<a class=headerlink href=#3-wait-for-instance-to-be-ready title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=c1># Wait for ArgoCD instance to be ready</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=k>while</span><span class=w> </span>!<span class=w> </span>oc<span class=w> </span><span class=nb>wait</span><span class=w> </span>pod<span class=w> </span>--timeout<span class=o>=</span>-1s<span class=w> </span>--for<span class=o>=</span><span class=nv>condition</span><span class=o>=</span>ContainersReady<span class=w> </span>-l<span class=w> </span>app.kubernetes.io/name<span class=o>=</span>openshift-gitops-cntk-server<span class=w> </span>-n<span class=w> </span>openshift-gitops<span class=w> </span>&gt;<span class=w> </span>/dev/null<span class=p>;</span><span class=w> </span><span class=k>do</span><span class=w> </span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;Waiting for ArgoCD instance...&quot;</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=w>    </span>sleep<span class=w> </span><span class=m>30</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=k>done</span>
</span></code></pre></div> <div class="admonition note"> <p class=admonition-title>Installation Timing</p> <p>The custom ArgoCD instance installation is an asynchronous process. The operator installation takes time, and once the operator is installed, the custom ArgoCD instance also takes time to create. The wait commands ensure all components are fully ready before proceeding.</p> </div> <h3 id=4-configure-ssl-certificate-optional>4. Configure SSL Certificate (Optional)<a class=headerlink href=#4-configure-ssl-certificate-optional title="Permanent link">&para;</a></h3> <div class="admonition warning"> <p class=admonition-title>Firefox Browser Users</p> <p>If you are using Firefox, you will not be able to access the ArgoCD console until a valid certificate has been associated with it. Other browsers are unaffected.</p> </div> <div class="language-bash highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=c1># Create temporary directory</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>mkdir<span class=w> </span>/tmp/argocd-cert
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=nb>cd</span><span class=w> </span>/tmp/argocd-cert
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=c1># Extract the ingress certificate</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=nv>ingress_secret_name</span><span class=o>=</span><span class=k>$(</span>oc<span class=w> </span>get<span class=w> </span>ingresscontroller.operator<span class=w> </span>default<span class=w> </span><span class=se>\</span>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=w>  </span>--namespace<span class=w> </span>openshift-ingress-operator<span class=w> </span><span class=se>\</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a><span class=w>  </span>-o<span class=w> </span><span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.spec.defaultCertificate.name}&#39;</span><span class=k>)</span>
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a>
</span><span id=__span-13-10><a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a>oc<span class=w> </span>extract<span class=w> </span>secret/<span class=nv>$ingress_secret_name</span><span class=w> </span>-n<span class=w> </span>openshift-ingress
</span><span id=__span-13-11><a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a>
</span><span id=__span-13-12><a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a><span class=c1># Create TLS secret for ArgoCD</span>
</span><span id=__span-13-13><a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a>oc<span class=w> </span>create<span class=w> </span>secret<span class=w> </span>tls<span class=w> </span>-n<span class=w> </span>openshift-gitops<span class=w> </span>openshift-gitops-cntk-tls<span class=w> </span><span class=se>\</span>
</span><span id=__span-13-14><a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a><span class=w>  </span>--cert<span class=o>=</span>tls.crt<span class=w> </span>--key<span class=o>=</span>tls.key<span class=w> </span>--dry-run<span class=o>=</span>client<span class=w> </span>-o<span class=w> </span>yaml<span class=w> </span><span class=p>|</span><span class=w> </span>oc<span class=w> </span>apply<span class=w> </span>-f<span class=w> </span>-
</span><span id=__span-13-15><a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a>
</span><span id=__span-13-16><a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a><span class=c1># Clean up</span>
</span><span id=__span-13-17><a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a><span class=nb>cd</span><span class=w> </span>..
</span><span id=__span-13-18><a id=__codelineno-13-18 name=__codelineno-13-18 href=#__codelineno-13-18></a>rm<span class=w> </span>-rf<span class=w> </span>/tmp/argocd-cert
</span></code></pre></div> <h2 id=accessing-argocd>Accessing ArgoCD<a class=headerlink href=#accessing-argocd title="Permanent link">&para;</a></h2> <h3 id=1-get-argocd-url>1. Get ArgoCD URL<a class=headerlink href=#1-get-argocd-url title="Permanent link">&para;</a></h3> <p>ArgoCD can be accessed via an OpenShift route:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=c1># Get the ArgoCD route URL</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>oc<span class=w> </span>get<span class=w> </span>route<span class=w> </span>openshift-gitops-cntk-server<span class=w> </span>-n<span class=w> </span>openshift-gitops<span class=w> </span>-o<span class=w> </span><span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{&quot;https://&quot;}{.spec.host}{&quot;\n&quot;}&#39;</span>
</span></code></pre></div> <p>Example output: <div class="language-text highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>https://openshift-gitops-cntk-server-openshift-gitops.apps.itz-pokxlu.hub01-lb.techzone.ibm.com
</span></code></pre></div></p> <h3 id=2-access-argocd-console>2. Access ArgoCD Console<a class=headerlink href=#2-access-argocd-console title="Permanent link">&para;</a></h3> <ol> <li>Copy the URL from your terminal output into your browser</li> <li>You should see the ArgoCD login page:</li> </ol> <p><img alt="ArgoCD Login" src=../images/argo71.png></p> <div class="admonition note"> <p class=admonition-title>Certificate Warnings</p> <p>You can safely ignore any browser certificate warnings.</p> </div> <h3 id=3-authentication-options>3. Authentication Options<a class=headerlink href=#3-authentication-options title="Permanent link">&para;</a></h3> <p>ArgoCD provides two authentication mechanisms:</p> <h4 id=option-1-argocd-administrator-recommended>Option 1: ArgoCD Administrator (Recommended)<a class=headerlink href=#option-1-argocd-administrator-recommended title="Permanent link">&para;</a></h4> <p>Use the ArgoCD service account credentials for full administrative access:</p> <ul> <li><strong>Username:</strong> <code>admin</code></li> <li><strong>Password:</strong> Retrieve using the following command:</li> </ul> <div class="language-bash highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a>oc<span class=w> </span>extract<span class=w> </span>secret/openshift-gitops-cntk-cluster<span class=w> </span>-n<span class=w> </span>openshift-gitops<span class=w> </span>--keys<span class=o>=</span><span class=s2>&quot;admin.password&quot;</span><span class=w> </span>--to<span class=o>=</span>-
</span></code></pre></div> <h4 id=option-2-openshift-sso>Option 2: OpenShift SSO<a class=headerlink href=#option-2-openshift-sso title="Permanent link">&para;</a></h4> <p>Use your OpenShift Single Sign-On credentials:</p> <ol> <li>Click <strong>"Login with OpenShift"</strong></li> <li>Grant access to the ArgoCD Service Account when prompted:</li> </ol> <p><img alt="ArgoCD OpenShift Access" src=../images/argo-access.png></p> <div class="admonition note"> <p class=admonition-title>Permission Differences</p> <p>OpenShift SSO authentication provides sufficient permissions to complete the tutorial, but you won't have full administrative access to perform all ArgoCD operations.</p> </div> <h3 id=4-argocd-dashboard>4. ArgoCD Dashboard<a class=headerlink href=#4-argocd-dashboard title="Permanent link">&para;</a></h3> <p>Once logged in, you'll see the ArgoCD dashboard:</p> <p><img alt="ArgoCD Applications" src=../images/argo-applications.png></p> <p>Notice that there are no ArgoCD applications active at the moment. In the next section, we'll configure ArgoCD to create the <strong>ArgoCD applications</strong> that will spin up <strong>infrastructure</strong>, <strong>service</strong>, and <strong>application</strong> resources.</p> <h2 id=connect-argocd>Connect ArgoCD<a class=headerlink href=#connect-argocd title="Permanent link">&para;</a></h2> <p>Let's now connect your customized GitOps repository to the instance of ArgoCD running in the cluster. Once connected, ArgoCD will use the contents of this repository to create matching resources in the cluster. It will also keep the cluster synchronized with any changes to the GitOps repository.</p> <h3 id=1-review-the-bootstrap-single-cluster-argocd-application>1. Review the Bootstrap-Single-Cluster ArgoCD Application<a class=headerlink href=#1-review-the-bootstrap-single-cluster-argocd-application title="Permanent link">&para;</a></h3> <p>Recall that you pushed the customized local copy of the GitOps repository to your GitHub account. The repository contains a bootstrap-single-cluster ArgoCD application that, when deployed to the cluster, will continuously watch this repository and use its contents to synchronize the cluster.</p> <p>The <code>0-bootstrap/single-cluster/bootstrap.yaml</code> file is used to create our first ArgoCD application called bootstrap-single-cluster. This initial ArgoCD application effectively bootstraps the cluster by creating all the other ArgoCD applications that control the infrastructure, service and application resources deployed to the cluster.</p> <p>Examine the YAML that defines the ArgoCD bootstrap application:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a>cat<span class=w> </span><span class=m>0</span>-bootstrap/single-cluster/bootstrap.yaml
</span></code></pre></div> <p>You should see:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">argoproj.io/v1alpha1</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Application</span>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=nt>metadata</span><span class=p>:</span>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">bootstrap-single-cluster</span>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">openshift-gitops</span>
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a><span class=nt>spec</span><span class=p>:</span>
</span><span id=__span-18-7><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=w>  </span><span class=nt>destination</span><span class=p>:</span>
</span><span id=__span-18-8><a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a><span class=w>    </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">openshift-gitops</span>
</span><span id=__span-18-9><a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a><span class=w>    </span><span class=nt>server</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">https://kubernetes.default.svc</span>
</span><span id=__span-18-10><a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a><span class=w>  </span><span class=nt>project</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
</span><span id=__span-18-11><a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a><span class=w>  </span><span class=nt>source</span><span class=p>:</span>
</span><span id=__span-18-12><a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0-bootstrap/single-cluster</span>
</span><span id=__span-18-13><a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a><span class=w>    </span><span class=nt>repoURL</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/YOUR-ORG/multi-tenancy-gitops.git</span>
</span><span id=__span-18-14><a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a><span class=w>    </span><span class=nt>targetRevision</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">main</span>
</span><span id=__span-18-15><a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a><span class=w>  </span><span class=nt>syncPolicy</span><span class=p>:</span>
</span><span id=__span-18-16><a id=__codelineno-18-16 name=__codelineno-18-16 href=#__codelineno-18-16></a><span class=w>    </span><span class=nt>automated</span><span class=p>:</span>
</span><span id=__span-18-17><a id=__codelineno-18-17 name=__codelineno-18-17 href=#__codelineno-18-17></a><span class=w>      </span><span class=nt>prune</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-18-18><a id=__codelineno-18-18 name=__codelineno-18-18 href=#__codelineno-18-18></a><span class=w>      </span><span class=nt>selfHeal</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span></code></pre></div> <div class="admonition important"> <p class=admonition-title>Repository Customization</p> <p>Make sure the <code>repoURL</code> points to your forked repository. Replace <code>YOUR-ORG</code> with your GitHub organization name.</p> </div> <p>Within this repository, the folder <code>path: 0-bootstrap/single-cluster</code> refers to a folder that contains all the other ArgoCD applications that are used to manage cluster resources.</p> <p>By deploying this ArgoCD application to a cluster, we are effectively linking our GitOps repository to that cluster.</p> <h3 id=2-apply-argocd-bootstrapyaml-to-the-cluster>2. Apply ArgoCD Bootstrap.yaml to the Cluster<a class=headerlink href=#2-apply-argocd-bootstrapyaml-to-the-cluster title="Permanent link">&para;</a></h3> <p>Let's now deploy the bootstrap-single-cluster ArgoCD application to bootstrap the cluster.</p> <p>Issue the following command to apply the bootstrap YAML to the cluster:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a>oc<span class=w> </span>apply<span class=w> </span>-f<span class=w> </span><span class=m>0</span>-bootstrap/single-cluster/bootstrap.yaml
</span></code></pre></div> <p>Kubernetes will confirm that the bootstrap-single-cluster resource has been created:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a>application.argoproj.io/bootstrap-single-cluster created
</span></code></pre></div> <p>Notice that:</p> <ul> <li><code>application.argoproj.io</code> indicates that this is an ArgoCD application.</li> <li>The bootstrap-single-cluster ArgoCD application is now watching the 0-bootstrap/single-cluster folder in our multi-tenancy-gitops repository on GitHub.</li> <li>This is the only direct cluster operation we need to perform; from now on, all cluster operations will be performed via Git operations to this repository.</li> </ul> <h3 id=3-verify-the-bootstrap-deployment>3. Verify the Bootstrap Deployment<a class=headerlink href=#3-verify-the-bootstrap-deployment title="Permanent link">&para;</a></h3> <p>We can use the command line to verify that the bootstrap ArgoCD application is running.</p> <p>Issue the following command:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a>oc<span class=w> </span>get<span class=w> </span>app/bootstrap-single-cluster<span class=w> </span>-n<span class=w> </span>openshift-gitops
</span></code></pre></div> <p>You should see that the bootstrap application was recently updated:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a>NAME                       SYNC STATUS   HEALTH STATUS
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>bootstrap-single-cluster   Synced        Healthy
</span></code></pre></div> <p><code>SYNC STATUS</code> may temporarily show <code>OutOfSync</code> or <code>HEALTH_STATUS</code> may temporarily show Missing; simply re-issue the command to confirm it moves to Synced and Healthy.</p> <h3 id=4-using-the-ui-to-view-the-newly-deployed-argocd-applications>4. Using the UI to View the Newly Deployed ArgoCD Applications<a class=headerlink href=#4-using-the-ui-to-view-the-newly-deployed-argocd-applications title="Permanent link">&para;</a></h3> <p>We can also use the ArgoCD web console to view the Kubernetes resources deployed to the cluster. Switch back to the web console, refresh the page and you should see the <code>bootstrap-single-cluster</code> ArgoCD application together with three other ArgoCD applications:</p> <p><img alt="ArgoCD Application List" src=../images/argo-app-list.png></p> <p>(You may need to select <code>List</code> view rather than the <code>Tiles</code> view.)</p> <p>We can see that four ArgoCD applications have been deployed to the cluster as a result of applying <code>bootstrap.yaml</code>.</p> <p>The first ArgoCD application is the <code>bootstrap-single-cluster</code> ArgoCD application. It has created three other ArgoCD applications:</p> <ul> <li><strong><code>infra</code></strong> watches for <strong>infrastructure</strong> components to be synchronized with the cluster.</li> <li><strong><code>services</code></strong> watches for <strong>service</strong> components to be synchronized with the cluster.</li> <li><strong><code>applications</code></strong> watches for <strong>application</strong> components to be synchronized with the cluster.</li> </ul> <p>As resources are added, updated or removed to the <strong>infrastructure</strong>, <strong>service</strong> and <strong>application</strong> folders watched by these applications, the cluster will be kept synchronized with the contents of the corresponding folder.</p> <p>We'll see how these applications work in more detail in the next sections.</p> <h3 id=5-the-bootstrap-single-cluster-argocd-application-in-detail>5. The Bootstrap-Single-Cluster ArgoCD Application in Detail<a class=headerlink href=#5-the-bootstrap-single-cluster-argocd-application-in-detail title="Permanent link">&para;</a></h3> <p>In the ArgoCD UI <strong>Applications</strong> view, click on the bootstrap-single-cluster application:</p> <p><img alt="Bootstrap Single Cluster Detail" src=../images/boostrap-single-cluster-1.png></p> <p>You can see the bootstrap application creates two types of Kubernetes resources, namely ArgoCD <code>applications</code> and ArgoCD <code>projects</code> for <code>infra</code>, <code>services</code> and <code>applications</code>.</p> <p>An ArgoCD <strong>project</strong> is a mechanism by which we can group related resources; we keep all our ArgoCD applications that manage infrastructure in the <code>infra</code> project, all applications that manage services in the <code>services</code> project, and so on.</p> <h2 id=next-steps>Next Steps<a class=headerlink href=#next-steps title="Permanent link">&para;</a></h2> <p>With ArgoCD connected and the bootstrap application deployed, you're ready to:</p> <ol> <li><strong>Deploy Infrastructure</strong> - Set up namespaces, RBAC, and foundational resources</li> <li><strong>Install Cloud Pak for Integration</strong> - Deploy CP4I with GitOps automation</li> <li><strong>Deploy ACE Applications</strong> - Build and deploy your ACE applications</li> </ol> <div class="admonition success"> <p class=admonition-title>Congratulations!</p> <p>You have successfully created the GitOps repository for your cluster and examined its high-level structure. You also installed ArgoCD with a custom instance that includes IBM Cloud Pak-specific health checks. You created specific <strong>clusterrole</strong> and <strong>clusterrolebinding</strong> for the ArgoCD service account to ensure that it manages the cluster in a well-governed manner. Finally, you launched the UI for ArgoCD; you will make extensive use of it during this tutorial.</p> <p>In the next topic of this chapter, we are going to customize the GitOps repository for your cluster and use Tekton and ArgoCD to create and manage the Kubernetes resources for our ACE applications.</p> </div> <h2 id=troubleshooting>Troubleshooting<a class=headerlink href=#troubleshooting title="Permanent link">&para;</a></h2> <h3 id=common-issues>Common Issues<a class=headerlink href=#common-issues title="Permanent link">&para;</a></h3> <p><strong>ArgoCD Installation Delays</strong> - Check operator subscription status: <code>oc get subscription -n openshift-operators</code> - Verify operator pod status: <code>oc get pods -n openshift-operators</code> - Check ArgoCD namespace: <code>oc get pods -n openshift-gitops</code></p> <p><strong>Authentication Issues</strong> - Verify the admin password extraction command - Check OpenShift SSO configuration - Ensure proper cluster permissions</p> <p><strong>Route Access Problems</strong> - Verify the route exists: <code>oc get route -n openshift-gitops</code> - Check certificate configuration for Firefox users - Ensure network connectivity to the cluster</p> <h3 id=support-resources>Support Resources<a class=headerlink href=#support-resources title="Permanent link">&para;</a></h3> <ul> <li><a href=https://argoproj.github.io/argo-cd/ >ArgoCD Documentation</a></li> <li><a href=https://docs.openshift.com/container-platform/4.16/cicd/gitops/understanding-openshift-gitops.html>OpenShift GitOps Documentation</a></li> <li><a href=https://www.ibm.com/docs/en/cloud-paks/cp-integration/16.1.2>IBM Cloud Pak for Integration Documentation</a></li> <li><a href=https://argoproj.github.io/argo-cd/operator-manual/health/ >ArgoCD Resource Health</a> - Custom health check documentation</li> </ul> <div class="admonition note"> <p class=admonition-title>Monitoring Solutions</p> <p>For production environments, consider implementing a comprehensive monitoring solution such as IBM Instana or similar enterprise monitoring platforms. These solutions provide advanced observability, performance monitoring, and alerting capabilities for ACE applications and the underlying infrastructure.</p> </div> <hr> <p><strong>Next Steps:</strong> Once ArgoCD is configured, proceed to <a href=add-infrastructure.md>Add Infrastructure</a> to set up the foundational resources for your ACE deployment. </p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="August 5, 2025 18:11:06 UTC">August 5, 2025</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="August 5, 2025 02:53:57 UTC">August 5, 2025</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/ibmexpertlabs target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://www.linkedin.com/company/ibm/ target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy", "content.code.annotate"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../assets/javascripts/bundle.13a4f30d.min.js></script> </body> </html>